## Place this file (or symlink it) under /etc/default/celeryd

# Extra arguments to celeryd
CELERYD_OPTS_GRP1="--queues entity_resolver,dispatcher,fbs_search_aggregate,fbs_concept_aggregate,fbs_aggregate,entity_reporter -c 1"
CELERYD_OPTS_GRP2="--queues priority2 -c 20 --schedule=/var/run/celery/celerybeat-schedule"
CELERYD_OPTS_GRP3="--queues priority5 -c 20 --schedule=/var/run/celery/celerybeat-schedule"
CELERYD_OPTS_GRP4="--queues priority8 -c 20 --schedule=/var/run/celery/celerybeat-schedule"
#CELERYD_OPTS_GRP5="--queues dispatcher -c 1 -B --schedule=/var/run/celery/celerybeat-schedule"


re='[^0-9]+$'
THIS_HOST="$(hostname)"
THIS_HOST="${THIS_HOST%%.ck12.org}"
if [ "${THIS_HOST%%1}" != "${THIS_HOST}" ] || [[ ${THIS_HOST} =~ ${re} ]]; then
    CELERYD_OPTS_GRP1="${CELERYD_OPTS_GRP1} -B --schedule=/var/run/celery/celerybeat-schedule"
fi

# Where to chdir at start.
CELERYD_CHDIR_GRP1="/opt/2.0/dexter/core/pyramid"
CELERYD_CHDIR_GRP2="/opt/2.0/dexter/core/pyramid"
CELERYD_CHDIR_GRP3="/opt/2.0/dexter/core/pyramid"
CELERYD_CHDIR_GRP4="/opt/2.0/dexter/core/pyramid"

CELERYD_LOG_FILE="/var/log/celery/celeryd-_n.log"

CELERYD_LOG_LEVEL="INFO"

# Workers should run as an unprivileged user.
CELERYD_USER=`grep -s APACHE_RUN_USER /etc/apache2/envvars |sed 's/export APACHE_RUN_USER=//'`
CELERYD_USER=${CELERYD_USER:-www-data}
CELERYD_GROUP=`grep -s APACHE_RUN_GROUP /etc/apache2/envvars |sed 's/export APACHE_RUN_GROUP=//'`
CELERYD_GROUP=${CELERYD_GROUP:-www-data}

# PAth to celeryd
#CELERYD="/usr/local/bin/paster celeryd celeryconfig.py"

# Name of the celery config module.#
#CELERY_CONFIG_MODULE="celeryconfig"
