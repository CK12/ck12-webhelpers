{% set resources = c.paginator.current_page.items() %}
{% extends "mylibrary/common.html" %}
{% from "macros/attachments.html" import ck12_artifact_edit_resource with context %}

{% block js %}
{{ super() }}
<script>
var items_json = [];
{% if c.labels_json %}
var labels_json = {{c.labels_json}};
{% else %}
var labels_json = []
{% endif %}

{% if c.selected_label %}
var selected_label = "{{c.selected_label}}";
{% endif %}
</script>
{% endblock %}

{#% block top_actions %}
	<div class="prefix_2 grid_2">
		<a class="button turquoise" id="changeLabels" href="#" title="{{ _('Change Labels') }}">{{ _('Change Labels') }}</a>
	</div>
{% endblock %#}

{% block results_area %}
	{% for resource in resources %}
	<ul id="item_{{resource.get('resourceRevisionID')}}" class="rowlist js_library_row js_resource_row my_files clearfix" data-resource-id="{{resource.id}}" data-resource-name="{{resource.name}}" data-resource-type="{{resource.type}}">
		<li><input class="js_row_check" type="checkbox"></li>
		<li><div class="missingimage"></div></li>
		<li class="libraryartifacttitle">
			<a href="{{ h.url(controller='resource', action='resource_details', resource_type=resource.type, resource_handle=resource.handle, realm=resource.realm, stream=None )  }}">{{ resource.name }}</a>
			<div class="js_artifact_labels">
				{% for label in resource.getLibraryLabels() %}
				<span title="{{label}}" data-label="{{label}}" class="labels">
					{{ label|truncate(20,killwords=true)|escape}}
				</span>
				{% endfor %}
			</div>
		</li>
		{% if not c.selected_label == 'archived' %}
		<li class="actions">
			<a href="#" class="js_archive" title="{{ _('Move to Archived') }}">
				<span class="icon-remove"></span>
			</a>
            <a href="#" class="js_resource_edit myresource_edit" data-resource-id="{{ resource.id }}" data-resource-revision-id="{{ resource.resourceRevisionID }}" data-resource-public="{{resource.isPublic}}"><span class="icon-edit"></span></a>
            <span class="hide js_resource_description" >{{ resource.description }}</span>
		</li>
		{% endif %}
		<div class="divider"></div>
	</ul>
	{% endfor %}
{% endblock %}

{% block hidden_divs %}
{{ super() }}
{{ ck12_artifact_edit_resource() }}
<div id="items_json_data">
	{{ resources|ck12_json|escape }}
</div>
{% endblock %}
