!function(){"use strict";var a="";tinymce.create("tinymce.plugins.CK12Rosetta",{init:function(b,c){function d(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}}a=c;var e=["bold","ck12highlight","ck12textcolor","italic","link","strikethrough","subscript","superscript","underline"],f={buttons:e,menu:e};b.on("nodechange",function(a){var b=this,c=a.element,d=!1;if(("H3"===c.nodeName||"H4"===c.nodeName||"H5"===c.nodeName||"H6"===c.nodeName||"H2"===c.nodeName||"H1"===c.nodeName)&&(d=!0),d?b.fire("disable",f):b.fire("enable",f),b.fire("enable",{buttons:["formatselect","blockquote"]}),c&&c.parentNode&&"BLOCKQUOTE"===c.parentNode.nodeName?b.fire("disable",{button:"formatselect"}):b.fire("enable",{button:"formatselect"}),b&&b.parents&&b.parents.length>0)for(var e=0;e<b.parents.length;e++){var g=b.parents[e];"BLOCKQUOTE"===g.tagName.toUpperCase()&&b.fire("disable",{button:"formatselect"})}(d||c&&"PRE"===c.nodeName)&&b.fire("disable",{button:"blockquote"})}),b.on("preprocess",function(a){var b,c,d,e=this,f=e.dom;for(b=f.select(".ck12-media-placeholder"),d=b.length;d--;)c=b[d],null!==c.parentNode&&"P"!==c.parentNode.nodeName&&$(c).wrap("<P/>");for(b=f.select(".x-ck12-editor-clearbottom"),d=b.length;d--;)if(c=b[d],0!==$(c).children().length||$.trim($(c).text()).length>0){var g=c.innerHTML;$(c).replaceWith("<p>"+g+"</p>")}else f.remove($(c));for(b=f.select("img"),d=b.length;d--;){var c=b[d],h=$(c).attr("data-flx-url");if(("undefined"!=typeof h||"string"!=typeof h)&&(h=c.attributes["data-flx-url"]?c.attributes["data-flx-url"].nodeValue:null),h)$(c).attr("src",h),$(c).attr("data-mce-src",h);else{var i=$(c).attr("src");"string"!=typeof i&&(i=c.attributes.src?c.attributes.src.nodeValue:"");var j=i.indexOf("/flx/");-1!==j&&0!==j&&(i=i.substring(j),$(c).attr("src",i),$(c).attr("data-mce-src",i))}$(c).removeAttr("data-flx-url")}}),b.on("undo",function(){b.fire("contextmenu:hide")}),b.on("redo",function(){b.fire("contextmenu:hide")}),b.on("init",function(){b.formatter.register("underline",{inline:"span",classes:"x-ck12-underline"}),b.formatter.register("strikethrough",{inline:"span",classes:"x-ck12-strikethrough"})}),b.on("preinit",function(){b.parser.addNodeFilter("ol",function(a){for(var b,c=a.length;c--;){b=a[c];var d=b.attr("class")||"";if(-1!==d.indexOf("x-ck12-")){var e="";-1!==d.indexOf("x-ck12-lower-alpha")?e="list-style-type: lower-alpha;":-1!==d.indexOf("x-ck12-upper-alpha")?e="list-style-type: upper-alpha;":-1!==d.indexOf("x-ck12-lower-roman")?e="list-style-type: lower-roman;":-1!==d.indexOf("x-ck12-upper-roman")&&(e="list-style-type: upper-roman;"),b.attr("class",null),b.attr("style",e)}}}),b.serializer.addNodeFilter("ol",function(a,b,c){for(var d,e=a.length;e--;){d=a[e];var f=d.attr("class")||"";if(-1===f.indexOf("x-ck12-")){var g=d.attr("style")||"",f=null;-1!==g.indexOf("lower-alpha")?f="x-ck12-lower-alpha":-1!==g.indexOf("upper-alpha")?f="x-ck12-upper-alpha":-1!==g.indexOf("lower-roman")?f="x-ck12-lower-roman":-1!==g.indexOf("upper-roman")&&(f="x-ck12-upper-roman"),d.attr("class",f),d.attr("style",null)}}}),b.serializer.addNodeFilter("img",function(a,b,c){for(var d,e=a.length;e--;){d=a[e];var f=d.attr("longdesc")||"";f&&d.attr("longdesc",encodeURIComponent(decodeURIComponent(f)))}})});var g=d(function(){b.nodeChanged()},500);b.on("loadcontent keyup mouseup",g),b.on("focus:window",function(){var a,b,c=tinymce.activeEditor.windowManager.windows[0].$el,d=c.find("input, textarea");return d.length>0?void d.first().on("load",function(){this.focus()}):(a=c.find("iframe"),void(a.length>0&&a.on("load",function(){b=$(a[0].contentWindow.document),d=b.find("input, textarea"),d.length>0&&d.first().focus()})))})},getInfo:function(){return{longname:"CK-12 Text Colors",author:"Nachiket Karve",authorurl:"http://www.ck12.org",infourl:"https://insight.ck12.org/wiki/index.php/Tinymce-flxweb",version:"1.0"}}}),tinymce.PluginManager.add("ck12rosetta",tinymce.plugins.CK12Rosetta)}();