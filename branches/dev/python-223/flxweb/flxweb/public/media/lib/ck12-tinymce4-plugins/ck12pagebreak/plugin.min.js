!function(){tinymce.create("tinymce.plugins.CK12PageBreakPlugin",{init:function(a,b){var c,d='<hr class="x-ck12-pagebreak" />',e="x-ck12-pagebreak",f=a.getParam("pagebreak_separator","<!-- pagebreak -->");c=new RegExp(f.replace(/[\?\.\*\[\]\(\)\{\}\+\^\$\:]/g,function(a){return"\\"+a}),"g"),a.addCommand("x-ck12-pagebreak",function(){a.execCommand("mceInsertContent",0,d)}),a.addButton("pagebreak",{title:"Pagebreak",cmd:e}),a.on("init",function(){a.on("ResolveName",function(b){"HR"==b.target.nodeName&&a.dom.hasClass(b.target,e)&&(b.name="pagebreak")})}),a.on("click",function(b){var c=b.target;"HR"===c.nodeName&&a.dom.hasClass(b,e)&&a.selection.select(c)}),a.on("nodechange",function(b){if(b&&b.parents&&b.parents.length>0)for(var c=0;c<b.parents.length;c++){var d=b.parents[c];"BR"==d.tagName.toUpperCase()||"P"==d.tagName.toUpperCase()?a.fire("enable",{button:"pagebreak"}):a.fire("disable",{button:"pagebreak"})}"HR"===b.element.nodeName&&a.dom.hasClass(b.element,e)?(a.fire("active",{button:"pagebreak"}),a.fire("enable",{button:"pagebreak"})):a.fire("inactive",{button:"pagebreak"})}),a.on("BeforeSetContent",function(a){a.content=a.content.replace(c,d)}),a.on("postprocess",function(a){a.get&&(a.content=a.content.replace(/<img[^>]+>/g,function(a){return-1!==a.indexOf('class="x-ck12-pagebreak')&&(a=f),a}))})},getInfo:function(){return{longname:"PageBreak",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/pagebreak",version:tinymce.majorVersion+"."+tinymce.minorVersion}}}),tinymce.PluginManager.add("ck12pagebreak",tinymce.plugins.CK12PageBreakPlugin)}();